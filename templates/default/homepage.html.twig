{% extends "base.html.twig" %}

{% block body %}
    <div id="container">
        <div id="heading">
            <div id="title">
                <h1>Hello on homepage, bitches!</h1>
            </div>
        </div>
        <div id="menu">
            <h3>Menu</h3>
         </div>
         <div id="content">
             <h2 style="text-align: center;">Content</h2>
             <div id="photos">
                <ul>
                   {% for i in 0..30 %}
                       <li class="photo-box">{{ i }} photo</li>
                   {% endfor %}
                </ul>
               <div style="clear: both;"></div>
            </div>
         </div>
         <div style="clear: both;"></div>
     </div>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('build/manifest.js') }}"></script>
    <script src="{{ asset('build/vendor.js') }}"></script>
    
    {# common scripts and css #}
    <script src="{{ asset('build/app.js') }}"></script>
    
    {# page specific scripts #}
    <script src="{{ asset('build/homepage.js') }}"></script>
    
    <script>
        document.addEventListener("DOMContentLoaded", function() {

            function init() {
                
                let heading = document.getElementById("heading");
                let content = document.getElementById("content");
                let menu = document.getElementById("menu");
                let windowWidth = window.innerWidth;
                {# scroll bar takes away 15px #}
                let contentWidth = windowWidth - 200 - 15;
                
                if (windowWidth > 740) {
                    
                    heading.style.height = "90px";
                                    
                    menu.style.width = "200px";
                    menu.style.visibility = "visible";
                                    
                    content.style.width = contentWidth + "px";
                    content.style.visibility = "visible";
                    
                } else {
                    
                    heading.style.height = "60px";
                    
                    pasteMenuBtn();
                    
                    menu.style.width = "0px";
                    menu.style.visibility = "hidden";
                    
                    content.style.width = windowWidth + "px";
                    content.style.visibility = "visible";
                }
            }
            init();
            
            function createMenuBtn() {
                
                let button = document.createElement('button');
                button.setAttribute('id', 'menuBtn');
                button.dataset.show = "false";
                // replace it with some menu picture in a future
                button.innerHTML = "menu";
                button.style.float = "left";
                
                return button;
            }
            
            function createBlankElement() {
                
                let div = document.createElement('div');
                div.setAttribute('id', 'blank');
                div.style.clear = "both";
                
                return div;
            }
            
            function pasteMenuBtn() {
                
                let menuBtn = createMenuBtn();
                let blankElement = createBlankElement();
                let heading = document.getElementById("heading");
                let title = document.getElementById("title");
                
                heading.insertBefore(menuBtn, title);
                heading.appendChild(blankElement);
            }
            
            function removeMenuBtn() {
                
                document.getElementById("menuBtn").remove();
                document.getElementById("blank").remove();
            }
            
            // it shouldn't work if menu is not defined yet            
            let toggleMenu = function(event) {
                
                var element = event.target;
                
                if(element.tagName === "BUTTON" && element.id === "menuBtn"){
                    
                    let menuBtn = document.getElementById("menuBtn");
                    let windowWidth = window.innerWidth;

                    if (menuBtn.dataset.show === "false") {
                        
                        menuBtn.dataset.show = "true";
                        
                        showMenuWithAnimiation();
                        
                        // wait 1 sec for animation end before hide content div
                        setTimeout(function() {
                            hideContent();
                        }, 1000);
                        
                    } else if (menuBtn.dataset.show === "true") {
                        
                        menuBtn.dataset.show = "false";
                        
                        showContent(windowWidth);
                        hideMenuWithAnimation();
                    }
                }
            };
            document.addEventListener("click", toggleMenu);
                  
            function showMenuWithAnimiation() {
                
                let menu = document.getElementById("menu");
                
                menu.classList.add("m-open");

                menu.style.zIndex = "1";
                menu.style.visibility = "visible";
                menu.style.height = "1000px";                

                changeMenuAnimationWidth();                
            }
            
            function hideMenuWithAnimation() {
                
                let menu = document.getElementById("menu");
                
                menu.style.zIndex = "auto";
                menu.style.width = "0px";
                menu.style.visibility = "hidden";
                
                menu.classList.remove("m-open");
            }
                    
            function showMenu(width = 200) {
                
                let menu = document.getElementById("menu");
                
                menu.style.visibility = "visible";
                menu.style.height = "1000px";
                menu.style.width = width + "px";
            }
                    
            function hideMenu() {
                
                let menu = document.getElementById("menu");
                
                menu.style.width = "0px";
                menu.style.visibility = "hidden";
            }
            
            function showContent(width) {
                
                let content = document.getElementById("content");
                
                content.style.visibility = "visible";
                content.style.height = "auto";
                content.style.width = width + "px";
            }
            
            function hideContent() {
                
                let content = document.getElementById("content");
                
                content.style.width = "0px";
                content.style.visibility = "hidden";
            }

            function changeMenuAnimationWidth() {
                
                let styleSheetNUMBER = '2';

                let windowWidth = window.innerWidth;
                let cssRules = document.styleSheets[styleSheetNUMBER].cssRules;
                let animationFrame;

                for (var i = 0; i < cssRules.length; i++) {
                    
                    if (document.styleSheets[styleSheetNUMBER].cssRules[i].name === 'menu-open') {

                        animationFrame = document.styleSheets[styleSheetNUMBER].cssRules[i];
                    }
                }
                
                animationFrame.appendRule('100% {width: ' + windowWidth + 'px;}');                
            }
            
            let onresize = function() {
                
                let heading = document.getElementById("heading");
                let content = document.getElementById("content");
                let windowWidth = window.innerWidth;
                let menu = document.getElementById("menu");
                let menuBtn = document.getElementById("menuBtn");
                // scroll bar takes away 15px
                let contentWidth = windowWidth - 200 - 15;

                if (windowWidth > 740) {
                    
                    menu.classList.remove("m-open");                   
                    heading.style.height = "90px";
                    
                    if (menuBtn) {
                        // when resize back to more then 740px set data-show to false if its true
                        if (menuBtn.getAttribute("data-show") === "true") {

                            menuBtn.dataset.show = "false";

                            hideMenu();
                        }
                        
                        removeMenuBtn();
                    }
                    
                    if (menu.style.visibility !== "visible") {
                        
                        showMenu();
                    }
                    
                    content.style.width = contentWidth + "px";
                    content.style.visibility = "visible";
                    
                } else {
                    
                    heading.style.height = "60px";
                    
                    if (!menuBtn) {
                        
                        // show menu buton in the left corner
                        pasteMenuBtn();
                    }
                                    
                    if (!menuBtn || menuBtn.getAttribute("data-show") === "false") {
                        
                        if (menu.style.visibility === "visible") {
                        
                            hideMenu();
                        }
                        
                    } else if (menuBtn.getAttribute("data-show") === "true") {

                        menu.style.width = windowWidth + "px";
                        
                        return;
                    }
                    
                    content.style.width = windowWidth + "px";
                    content.style.visibility = "visible";
                }
            };
            window.addEventListener("resize", onresize);
        });
    </script>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('build/homepage_style.css') }}"/>
    
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        
        #heading {
            text-align: center;
        }
    
        #menu {
            height: 1000px;
            background-color: khaki;
            visibility: hidden;
            float: left;
        }
        
        .m-open {
            position: absolute;
            left: 0px;
            top: 60px;
            -webkit-animation-name: menu-open;
            -webkit-animation-duration: 1s;
            animation-name: menu-open;
            animation-duration: 1s;
            animation-fill-mode: forwards;
        }
        
        @keyframes menu-open {
            0%   {width: 0px;}
            100% {width: 200px;}
        }
        
        #content {
            min-height: 1200px;
            height: auto;
            background-color: aqua;
            visibility: hidden;
            float: right;
        }
        
        #photos {
            
        }
        
        .photo-box {
            margin: 25px;
            list-style-type: none;
            border: blueviolet solid 2px;
            width: 14em;
            height: 14em;
            float: left;
        }
    </style>
{% endblock %}